{% set id = _component_context.id | default('') %}
{% set name = _component_context.name | default('') %}
{% set disabled = _component_context.disabled | default(false) %}
{% set required = _component_context.required | default(false) %}
{% set invalid = _component_context.invalid | default(false) %}
{% set focus = _component_context.focus | default(false) %}
{% set options = _component_context.options | default([]) %}
{% set content = _component_context.content | default('') %}
{% set default_value = _component_context.defaultValue | default('') %}
{% set value = _component_context.value | default('') %}
{% set additional_class = _component_context.class | default('') %}
{% set placeholder = _component_context.placeholder | default('') %}

{# Build CSS classes #}
{% set css_classes = ['utrecht-select', 'utrecht-select--html-select'] %}
{% if disabled %}{% set css_classes = css_classes + ['utrecht-select--disabled'] %}{% endif %}
{% if focus %}{% set css_classes = css_classes + ['utrecht-select--focus', 'utrecht-select--focus-visible'] %}{% endif %}
{% if invalid %}{% set css_classes = css_classes + ['utrecht-select--invalid'] %}{% endif %}
{% if required %}{% set css_classes = css_classes + ['utrecht-select--required'] %}{% endif %}
{% if additional_class %}{% set css_classes = css_classes + [additional_class] %}{% endif %}

<div class="rvo-select-wrapper" data-roos-component="select">
    <select 
        {% if id %}id="{{ id }}"{% endif %}
        {% if name %}name="{{ name }}"{% endif %}
        class="{{ css_classes | join(' ') }}"
        {% if disabled %}disabled{% endif %}
        {% if required %}required{% endif %}
        {% if invalid %}aria-invalid="true"{% endif %}
        {% if default_value %}data-default-value="{{ default_value }}"{% endif %}
        {% if value %}data-value="{{ value }}"{% endif %}
        {% if _component_context.get('@change') %}
            {% if roos_htmx %}
                {% if _component_context['@change'].startswith('hx-') %}
                    {{ _component_context['@change'] | safe }}
                {% else %}
                    onchange="{{ _component_context['@change'] }}"
                {% endif %}
            {% else %}
                onchange="{{ _component_context['@change'] }}"
            {% endif %}
        {% endif %}>
        
        {% if placeholder %}
            <option value="" disabled {% if not value and not default_value %}selected{% endif %}>
                {{ placeholder }}
            </option>
        {% endif %}

        {% if options %}
            {# Options attribute takes precedence over content #}
            {% for option in options %}
                {% if option is string %}
                    <option value="{{ option }}"
                        {% if option == value or (option == default_value and not value) %}selected{% endif %}>
                        {{ option }}
                    </option>
                {% else %}
                    <option value="{{ option.value }}"
                        {% if option.value == value or (option.value == default_value and not value) %}selected{% endif %}>
                        {{ option.label | default(option.value) }}
                    </option>
                {% endif %}
            {% endfor %}
        {% elif content %}
            {# Render content block (e.g., <option> elements) #}
            {{ content | safe }}
        {% endif %}
    </select>
</div>