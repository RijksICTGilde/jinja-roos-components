{% import 'components/_generic_attributes.j2' as attrs %}
{% set id = _component_context.id | default('') %}
{% set name = _component_context.name | default('') %}
{% set label = _component_context.label | default('') %}
{% set value = _component_context.value | default('') %}
{% set required = _component_context.required | default(false) %}
{% set disabled = _component_context.disabled | default(false) %}
{% set readonly = _component_context.readonly | default(false) %}
{% set size = _component_context.size | default('lg') %}
{% set helper_text = _component_context.helperText | default('Gebruik het formaat dd-mm-jjjj (bijvoorbeeld 01-09-2020)') %}
{% set error_message = _component_context.errorMessage | default('') %}
{% set has_error = _component_context.hasError | default(false) %}
{% set min_date = _component_context.minDate | default('') %}
{% set max_date = _component_context.maxDate | default('') %}
{% set additional_class = _component_context.class | default('') %}

{# Build CSS classes #}
{% set field_classes = ['utrecht-form-field', 'utrecht-form-field--date', 'rvo-form-field'] %}
{% if size != 'md' %}
    {% set field_classes = field_classes + ['rvo-form-field--' + size] %}
{% endif %}
{% if has_error or error_message %}
    {% set field_classes = field_classes + ['rvo-form-field--error'] %}
{% endif %}
{% if additional_class %}
    {% set field_classes = field_classes + [additional_class] %}
{% endif %}

{% set input_classes = ['utrecht-textbox', 'utrecht-textbox--html-input', 'utrecht-textbox--' + size, 'rvo-date-input'] %}
{% if has_error or error_message %}
    {% set input_classes = input_classes + ['utrecht-textbox--invalid'] %}
{% endif %}

<div
    class="{{ field_classes | join(' ') }}"
    data-roos-component="date-input-field"
    data-roos-size="{{ size }}"
    {% if has_error or error_message %}data-roos-has-error="true"{% endif %}>

    {% if label %}
        <div class="rvo-form-field__label">
            <label for="{{ id }}" class="rvo-label utrecht-form-label" id="{{ id }}-label">
                {{ label }}
                {% if required %}
                    <span class="rvo-required" aria-label="verplicht">*</span>
                {% endif %}
            </label>
            {% if helper_text and not error_message %}
                <div id="{{ id }}-help" class="utrecht-form-field-description">
                    {{ helper_text }}
                </div>
            {% endif %}
        </div>
    {% endif %}

    <input
        {% if id %}id="{{ id }}"{% endif %}
        {% if name %}name="{{ name }}"{% endif %}
        type="date"
        class="{{ input_classes | join(' ') }}"
        {% if value %}value="{{ value }}"{% endif %}
        {% if required %}required aria-required="true"{% endif %}
        {% if disabled %}disabled{% endif %}
        {% if readonly %}readonly{% endif %}
        {% if min_date %}min="{{ min_date }}"{% endif %}
        {% if max_date %}max="{{ max_date }}"{% endif %}
        {% if has_error or error_message %}aria-invalid="true"{% endif %}
        {% if error_message %}aria-describedby="{{ id }}-error"{% endif %}
        {% if helper_text %}aria-describedby="{{ id }}-help"{% endif %}
        {{ attrs.render_extra_attributes(_component_context) }} />
    
    {% if error_message %}
        <div id="{{ id }}-error" class="rvo-form-field__error-message" role="alert">
            {{ error_message }}
        </div>
    {% endif %}
    
</div>